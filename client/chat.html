<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Chat Room</title>
  <link rel="stylesheet" href="chat.css">
  <script src="encryption.js"></script>
  <script>
    // Check authentication before loading chat
    if (!localStorage.getItem("username") || !localStorage.getItem("authenticated")) {
      window.location.href = "login.html";
    }
    
    // Check for dark mode preference
    document.documentElement.className = localStorage.getItem("darkMode") === "true" ? "dark-mode" : "";
  </script>
  <script src="chat.js" defer></script>
</head>
<body>
  <h2>Chat Room</h2>
  <div id="chat-container">
    <div id="conversation-header" style="font-weight: bold; margin-bottom: 10px;"></div>
    <div id="chat-box">
      <div id="chat-messages"></div>
    </div>
    <div id="input-area">
      <div id="formatting-toolbar">
        <button type="button" id="bold-btn"><b>B</b></button>
        <button type="button" id="italic-btn"><i>I</i></button>
        <button type="button" id="underline-btn"><u>U</u></button>
        <button type="button" id="dark-mode-btn">ğŸŒ™</button>
      </div>
      <div id="message-input" class="message-input" contenteditable="true"></div>
      <button id="emoji-btn">ğŸ˜Š</button>
      <div id="emoji-panel" class="emoji-panel">
        <span class="emoji">ğŸ˜€</span>
        <span class="emoji">ğŸ˜„</span>
        <span class="emoji">ğŸ˜</span>
        <span class="emoji">ğŸ˜…</span>
        <span class="emoji">ğŸ‘Œ</span>
        <span class="emoji">ğŸ‘</span>
        <span class="emoji">ğŸ‘</span>
        <span class="emoji">ğŸ‘</span>
      </div>
      
      <!-- file upload interface -->
      <div id="file-upload-wrapper">
        <label for="fileInput" id="file-label">ğŸ“ Attach</label>
        <input type="file" id="fileInput">
        <span id="selected-file-name" class="file-name-display"></span>
      </div>
      
      <!-- File scanning indicator  -->
      <div id="file-scan-indicator" class="file-scan-indicator" style="display: none;">
        <span class="scan-spinner"></span>
        <span>Scanning file for security...</span>
      </div>
      
      <select id="who-to-send" name="who-to-send">
        <option value="All">All</option>
      </select>
      <button id="send-btn">Send</button>
      <button id="logout-btn">Logout</button>
    </div>
  </div>
</body>
</html>
